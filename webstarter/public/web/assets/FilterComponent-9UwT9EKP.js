var R=Object.defineProperty,$=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var S=(n,l,s)=>l in n?R(n,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[l]=s,v=(n,l)=>{for(var s in l||(l={}))O.call(l,s)&&S(n,s,l[s]);if(g)for(var s of g(l))Z.call(l,s)&&S(n,s,l[s]);return n},y=(n,l)=>$(n,A(l));import{r as p,$ as B,j as a,I as G}from"./index-BEnNszjz.js";import{Checkbox as q}from"./checkbox-D9A24uFJ.js";import{Select as f,SelectTrigger as w,SelectValue as N,SelectContent as D,SelectGroup as k,SelectItem as i}from"./select-Cns8l1Ii.js";import{R as z}from"./rotate-ccw-BzyNqpFm.js";import"./index-BdQq_4o_.js";import"./chevron-up-D99TzAZj.js";const W=({doctype:n,add_sort:l,filters:s,display_fields:E,children:F})=>{const[h,x]=p.useState({}),[_,V]=p.useState([]),[d,L]=p.useState("created_asc"),T=["name","creation",...s==null?void 0:s.map(e=>e.search_field||""),...E||[]].filter(Boolean),{data:u,error:C,isLoading:b}=B(n||"",{fields:T});p.useEffect(()=>{const e={};s==null||s.forEach(c=>{c.type==="Check"?e[c.search_field||""]=void 0:c.type==="Select"?e[c.search_field||""]="all":c.type==="Data"&&(e[c.search_field||""]="")}),x(e)},[s]);const j=(e,c)=>{x(t=>y(v({},t),{[e]:c}))},I=()=>{const e={};s==null||s.forEach(c=>{c.type==="Check"?e[c.search_field||""]=void 0:c.type==="Select"?e[c.search_field||""]="all":c.type==="Data"&&(e[c.search_field||""]="")}),x(e)};return p.useEffect(()=>{if(u){let e=u;s==null||s.forEach(c=>{const t=c.search_field||"",r=h[t];r!==void 0&&r!=="all"&&(c.type==="Check"?e=e.filter(o=>o[t]===r):c.type==="Select"?e=e.filter(o=>{var m;return((m=o[t])==null?void 0:m.toString().toLowerCase())===r.toString().toLowerCase()}):c.type==="Data"&&(e=e.filter(o=>{var m;return(m=o[t])==null?void 0:m.toString().toLowerCase().includes(r.toString().toLowerCase())})))}),e=e.sort((c,t)=>{var r,o;return d==="created_asc"?new Date(c.creation).getTime()-new Date(t.creation).getTime():d==="created_desc"?new Date(t.creation).getTime()-new Date(c.creation).getTime():d.includes("asc")?(r=c[d.replace("_asc","")])==null?void 0:r.localeCompare(t[d.replace("_asc","")]):d.includes("desc")?(o=t[d.replace("_desc","")])==null?void 0:o.localeCompare(c[d.replace("_desc","")]):0}),V(e)}},[u,h,d,s]),b?a.jsx("p",{children:"Loading..."}):C?a.jsxs("p",{children:["Error fetching data: ",C.message]}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex space-x-4 mb-4",children:[s&&s.map((e,c)=>a.jsxs("div",{className:"mb-4",children:[e.type==="Data"&&a.jsx(G,{type:"text",placeholder:`Search by ${e.search_field}`,value:h[e.search_field]||"",onChange:t=>j(e.search_field||"",t.target.value),className:"w-full max-w-sm"}),e.type==="Select"&&e.options&&a.jsxs(f,{onValueChange:t=>j(e.search_field||"",t),value:h[e.search_field],children:[a.jsx(w,{className:"w-[180px]",children:a.jsx(N,{placeholder:`Select ${e.search_field}`})}),a.jsx(D,{children:a.jsxs(k,{children:[a.jsx(i,{value:"all",children:"All"})," ",e.options.split(",").map((t,r)=>a.jsx(i,{value:t.trim(),children:t.trim()},r))]})})]}),e.type==="Check"&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(q,{id:e.search_field,checked:h[e.search_field]===!0,onCheckedChange:t=>j(e.search_field||"",!!t)}),a.jsx("label",{htmlFor:e.search_field,className:"text-sm font-medium",children:e.search_field})]})]},c)),l&&a.jsx("div",{className:"mb-4",children:a.jsxs(f,{onValueChange:e=>L(e),children:[a.jsx(w,{className:"w-[180px]",children:a.jsx(N,{placeholder:"Sort by"})}),a.jsx(D,{children:a.jsxs(k,{children:[a.jsx(i,{value:"created_asc",children:"Created (Oldest)"}),a.jsx(i,{value:"created_desc",children:"Created (Latest)"}),a.jsx(i,{value:"name_asc",children:"Name (A-Z)"}),a.jsx(i,{value:"name_desc",children:"Name (Z-A)"})]})})]})}),a.jsx("div",{children:a.jsxs("button",{onClick:I,className:"inline-flex items-center space-x-2 p-2  rounded  hover:text-primary",children:[a.jsx(z,{className:"h-4 w-4"}),a.jsx("span",{children:"Reset Filters"})]})})]}),F(_),_.length===0&&a.jsx("p",{children:"No documents found."})]})};export{W as default};
