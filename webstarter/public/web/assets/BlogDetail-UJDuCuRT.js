var k=(r,t,s)=>new Promise((u,m)=>{var x=o=>{try{d(s.next(o))}catch(c){m(c)}},i=o=>{try{d(s.throw(o))}catch(c){m(c)}},d=o=>o.done?u(o.value):Promise.resolve(o.value).then(x,i);d((s=s.apply(r,t)).next())});import{be as T,bf as te,bg as se,bh as ae,bi as L,bj as A,bk as I,bl as F,bm as re,bn as O,aa as ne,r as f,$ as P,M as le,bo as ce,W as oe,j as e,S as R,H as me,f as D,a as U,I as Y,B as z,L as ie}from"./index-BEnNszjz.js";import{Textarea as de}from"./textarea-BcY_xYkP.js";import{Avatar as xe,AvatarFallback as ue}from"./avatar-P5wJLDob.js";import{Alert as H,AlertTitle as $,AlertDescription as W}from"./alert-Bj6Nkwzt.js";import{C as he,F as fe,a as ge,T as je,M as be}from"./thumbs-up-DEscrRxG.js";import"./index-z7L-Afds.js";function ye(r,t){const s=+T(r)-+T(t);return s<0?-1:s>0?1:s}function Ne(r){return te(r,Date.now())}function pe(r){return t=>{const u=(r?Math[r]:Math.trunc)(t);return u===0?0:u}}function _e(r,t,s){var b,N,w;const u=re(),m=(N=(b=s==null?void 0:s.locale)!=null?b:u.locale)!=null?N:se,x=ye(r,t);if(isNaN(x))throw new RangeError("Invalid time value");const i=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:x}),[d,o]=ae(s==null?void 0:s.in,...x>0?[t,r]:[r,t]),c=pe((w=s==null?void 0:s.roundingMethod)!=null?w:"round"),j=o.getTime()-d.getTime(),g=j/O,v=L(o)-L(d),h=(j-v)/O,y=s==null?void 0:s.unit;let l;if(y?l=y:g<1?l="second":g<60?l="minute":g<A?l="hour":h<I?l="day":h<F?l="month":l="year",l==="second"){const n=c(j/1e3);return m.formatDistance("xSeconds",n,i)}else if(l==="minute"){const n=c(g);return m.formatDistance("xMinutes",n,i)}else if(l==="hour"){const n=c(g/60);return m.formatDistance("xHours",n,i)}else if(l==="day"){const n=c(h/A);return m.formatDistance("xDays",n,i)}else if(l==="month"){const n=c(h/I);return n===12&&y!=="month"?m.formatDistance("xYears",1,i):m.formatDistance("xMonths",n,i)}else{const n=c(h/F);return m.formatDistance("xYears",n,i)}}function ve(r,t){return _e(r,Ne(r),t)}const Ee=()=>{var S,B;const{name:r}=ne(),[t,s]=f.useState(null),[u,m]=f.useState([]),[x,i]=f.useState(""),[d,o]=f.useState(""),[c,j]=f.useState(""),[g,v]=f.useState(!1),[h,y]=f.useState(!1),l=r||"",{data:b,error:N,isLoading:w}=P("Blog Post",{fields:["name","title","meta_image","blog_category","published_on"],filters:[["blog_category","=",(S=t==null?void 0:t.blog_category)!=null?S:""],["name","!=",(B=t==null?void 0:t.name)!=null?B:""]],limit:3}),{data:n,error:C,isLoading:G,mutate:q}=le("Blog Post",l,{fields:["name","title","content","meta_title","meta_description","read_time","blogger","meta_image","creation","published_on","blog_category","tags","blog_intro","custom_like"]}),{data:p,error:M,mutate:J}=P("Comment",{fields:["comment_by","comment_email","content","creation"],filters:[["reference_doctype","=","Blog Post"],["reference_name","=",l],["comment_type","=","Comment"]],orderBy:{field:"creation",order:"desc"}}),{updateDoc:K}=ce(),{createDoc:Q}=oe();f.useEffect(()=>{n&&s(n),p&&m(p)},[n,p]);const V=()=>k(void 0,null,function*(){if(!x||!d||!c)return;const a={comment_type:"Comment",reference_doctype:"Blog Post",reference_name:r,comment_by:d,comment_email:c,content:x};try{yield Q("Comment",a),i(""),o(""),j(""),J(),v(!1)}catch(_){console.error("Error submitting comment:",_)}}),X=()=>k(void 0,null,function*(){if(h||!t)return;const a=(t.custom_like||0)+1;try{yield K("Blog Post",t.name,{custom_like:a}),y(!0),q()}catch(_){console.error("Error updating like count:",_)}});if(G)return e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(R,{})});if(C||M)return e.jsx("div",{className:"container mx-auto px-4 py-10",children:e.jsxs(H,{variant:"destructive",children:[e.jsx($,{children:"Error"}),e.jsx(W,{children:(C==null?void 0:C.message)||(M==null?void 0:M.message)||"Unknown error occurred"})]})});if(!t)return e.jsx("div",{children:e.jsx("p",{className:"text-center text-gray-500",children:"Blog not found."})});const Z=p?p.length:0,ee=t.custom_like||0;return e.jsxs("section",{className:"py-10",children:[e.jsxs(me,{children:[e.jsx("title",{children:t.meta_title||"Blog - Alool Technologies"}),e.jsx("meta",{name:"description",content:t.meta_description||"Read the latest blogs and updates from Alool Technologies."}),t.meta_image&&e.jsx("meta",{property:"og:image",content:t.meta_image})]}),e.jsxs("div",{className:"container mx-auto px-4 flex flex-col items-center",children:[e.jsxs("div",{className:"w-full max-w-2xl",children:[t.meta_image&&e.jsx("img",{src:t.meta_image,alt:t.meta_title||t.title,className:"w-full h-64 object-cover rounded-lg shadow-md mb-6"}),e.jsx("h1",{className:"text-4xl font-bold dark:text-foreground mb-4 text-left",children:t.title}),t.blog_intro&&e.jsx("p",{className:"dark:text-foreground mb-4 text-left",children:t.blog_intro}),e.jsxs("div",{className:"flex items-start lg:items-center dark:text-foreground text-sm mb-6 justify-start",children:[e.jsx(he,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:t.creation&&D(new Date(t.creation),"MMMM d, yyyy")}),e.jsx("span",{className:"mx-3",children:"/"}),e.jsx(fe,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:t.blog_category||"General"}),e.jsx("span",{className:"mx-3",children:"/"}),e.jsx(ge,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:t.read_time?`${t.read_time} min read`:"Unknown read time"})," "]}),e.jsx("hr",{className:"my-4 bg-gray-100 border-b-2 border-gray-200"}),e.jsx("div",{className:"prose dark:text-foreground max-w-none",dangerouslySetInnerHTML:{__html:t.content}}),e.jsxs("div",{className:"flex justify-between mt-10 mb-6 text-gray-600",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:X,children:[e.jsx(je,{className:`w-6 h-6 mr-1 ${h?"text-primary":"text-gray-600"}`}),e.jsxs("span",{children:[ee," "]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(be,{className:"w-6 h-6 mr-1 text-gray-600"}),e.jsxs("span",{children:[Z," "]})]})]}),e.jsx("div",{className:"flex items-center  ml-auto",children:e.jsx("span",{children:t.published_on&&D(new Date(t.published_on),"MMMM d, yyyy")})})]}),e.jsx(U,{}),e.jsx("div",{className:"mt-10",children:g?e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx(Y,{value:d,onChange:a=>o(a.target.value),placeholder:"Your Name",className:"w-1/2"}),e.jsx(Y,{value:c,onChange:a=>j(a.target.value),placeholder:"Your Email",className:"w-1/2"})]}),e.jsx(de,{value:x,onChange:a=>i(a.target.value),placeholder:"Your Comment",className:"mb-4 w-full"}),e.jsx(z,{onClick:V,className:"bg-primary text-white mt-4",children:"Submit Comment"})]}):e.jsx(z,{onClick:()=>v(!0),className:"bg-primary text-white",children:"Add Comment"})}),e.jsxs("div",{className:"mt-10 mb-10",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Comments"}),e.jsx("div",{className:"space-y-6",children:u.map((a,_)=>{var E;return e.jsxs("div",{className:"relative pl-10 mb-6 border-l-2  border-gray-200 dark:border-gray-700",children:[e.jsx(xe,{className:"absolute -left-6 top-0 bg-gray-100 dark:bg-gray-800",children:e.jsx(ue,{children:(E=a.comment_by)==null?void 0:E.slice(0,2)})}),e.jsxs("div",{className:" border p-6 rounded-xl mb-",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("strong",{className:"mr-2",children:a.comment_by}),e.jsx("span",{className:"text-gray-500 text-sm",children:ve(new Date(a.creation),{addSuffix:!0})})," "]}),e.jsx("p",{children:a.content})]})]},_)})})]})]}),e.jsx(U,{}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Related Blogs"}),w&&e.jsx(R,{})," ",N&&e.jsxs(H,{variant:"destructive",children:[e.jsx($,{children:"Error"}),e.jsx(W,{children:N.message||"Unable to load related blogs"})]}),e.jsx("div",{className:"grid grid-cols-1  sm:grid-cols-2 lg:grid-cols-3 gap-6",children:b==null?void 0:b.map(a=>e.jsx(ie,{to:`/blogs/${a.name}`,className:"group block hover:text-primary",children:e.jsxs("div",{className:"border rounded-lg overflow-hidden shadow-md",children:[a.meta_image&&e.jsx("img",{src:a.meta_image,alt:a.title,className:"w-full h-40 object-cover group-hover:scale-105 transition-transform"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"text-lg font-bold",children:a.title}),e.jsx("p",{className:"text-gray-500 text-sm",children:D(new Date(a.published_on||Date.now()),"MMMM d, yyyy")})]})]})},a.name))})]})]})]})};export{Ee as default};
